import Base from'./input-base';import{getMouseCoordinate}from'../../_internal/lib/lib';var doubleTapGapTime=500,isSingleFinger=function(a){return!a.touches||a.touches&&1===a.touches.length},zoomOnPoint=function(a,b,c,d){var e=Math.round,f=b-a.minValue,g=a.maxValue-b;return{min:e((b-f/c*(c-1))*d)/d,max:e((b+g/c*(c-1))*d)/d}};class InputDbTapZoom extends Base{constructor(){super();var a=this;a.controlArr=[{nativeInteraction:['touchstart','mouseup'],callback:a.tap.bind(a),component:a}]}getName(){return'dbTapZoom'}configure(){super.configure();var a=this;a.config.controlArr=[{nativeInteraction:['click'],callback:a.tap.bind(a),component:this}],this.enable()}setControl(){var a=this,b=a.controlArr,c=a.getLinkedParent();c.releaseControl(b),a.isEnabled()&&c.getControl(b)}tap(a){var b=this,c=b.config;a&&a.preventDefault();isSingleFinger(a.originalEvent)&&(c.tappedOnce?(b.zoom.apply(b,arguments),c.tappedOnce=!1):(c.tappedOnce=!0,setTimeout(function(){c.tappedOnce=!1},doubleTapGapTime)))}zoom(a){var b,c,d,e,f,g,h,i,j,k,l=this,m=l.getFromEnv('chart'),n=getMouseCoordinate(m.getLinkedItem('container'),a,m),o=l.config,p=o.hookFn,q={},r=!1,s=Math.pow(10,o.zoomDecimalLimit)||1;m.getFromEnv('animationManager').setAnimationState('zoom'),l.getFromEnv('axesObArr').forEach(function(a){b=a.axis,c=b.getValue(a.isY?n.chartY:n.chartX),e=b.getVisibleConfig(),d=zoomOnPoint(e,c,o.stepzoom,s),a.isY?(i=d.min,j=d.max):(g=d.min,h=d.max,q=l.constructor._getZoomInfo(g,h,b)),b.getZoom()<=s&&(p&&'function'==typeof o.hookFn&&p(d.min,d.max),f=b.setVisibleConfig(d.min,d.max),r=r||f,a.stack.push(e),k=a.stack.length+1)}),r&&l._raiseZoomEvents('zoomin','zoomedin',Object.assign(q,{level:k,startX:g,endX:h,startY:i,endY:j},a.originalEvent))}}export default InputDbTapZoom;